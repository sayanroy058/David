{% extends 'admin_base.html' %}

{% block extra_css %}
{{ super() }}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}

{% block content %}
<style>
  body {
    background-color:rgb(255, 255, 255);
    color: #f5f5f5;
  }

  .container h2 {
    color: #f1c40f;
    font-weight: 600;
    border-bottom: 2px solid #f1c40f;
    padding-bottom: 10px;
    margin-bottom: 20px;
  }

  .table {
    background-color: #333;
    color: #f5f5f5;
  }

  .table thead {
    background-color: #1c1c1c;
    color: #f1c40f;
  }

  .table-bordered th, .table-bordered td {
    border: 1px solid #555;
  }

  .btn-danger {
    background-color: #c0392b;
    border: none;
  }

  .btn-danger:hover {
    background-color: #e74c3c;
  }

  .table-striped tbody tr:nth-of-type(odd) {
    background-color: #2c2c2c;
  }

  .table-striped tbody tr:nth-of-type(even) {
    background-color: #3a3a3a;
  }
</style>

<div class="container mt-4">
  <h2>Full Order Details</h2>
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>Order Info</th>
        <th>Transaction Info</th>
        <th>Customer Info</th>
        <th>Item</th>
        <th>Type</th>
        <th>Quantity</th>
        <th>Price</th>
        <th>Created At</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for order in full_orders %}
      <tr>
        <td>{{ order.id }}</td>

        <td>
          {% if order.order %}
            <strong>Order ID:</strong> {{ order.custom_order_id or 'N/A' }}<br>
            <strong>Status:</strong> {{ order.order.status }}<br>
            <strong>Date:</strong> {{ order.order.date_created.strftime('%Y-%m-%d %H:%M') }}
          {% else %}
            N/A
          {% endif %}
        </td>

        <td>
          {% if order.transaction %}
            <strong>ID:</strong> {{ order.transaction.id }}<br>
            <strong>Amount:</strong> ₹{{ "%.2f"|format(order.transaction.amount) }}<br>
            <strong>Payment ID:</strong> {{ order.transaction.payment_id }}<br>
            <strong>Date:</strong> {{ order.transaction.date_created.strftime('%Y-%m-%d %H:%M') }}
          {% else %}
            N/A
          {% endif %}
        </td>

        <td>
          <strong>{{ order.full_name or 'N/A' }}</strong><br>
          <small><i class="fas fa-envelope"></i> {{ order.email or 'N/A' }}</small><br>
          <small><i class="fas fa-phone"></i> {{ order.phone or 'N/A' }}</small><br>
          
          {% if order.customer %}
            <div class="mt-2">
              <small><strong>Customer ID:</strong> {{ order.customer.id }}</small><br>
              <small><i class="fas fa-map-marker-alt"></i> 
                {{ order.customer.street_address or 'N/A' }}, 
                {{ order.customer.city or 'N/A' }}, 
                {{ order.customer.state or 'N/A' }} - {{ order.customer.pincode or 'N/A' }}
              </small>
            </div>
          {% elif order.address %}
            <small><i class="fas fa-map-marker-alt"></i> {{ order.address }}</small>
          {% else %}
            <small><i class="fas fa-map-marker-alt"></i> N/A</small>
          {% endif %}
        </td>

        <td>{{ order.item_title }}</td>
        <td>{{ order.item_type }}</td>
        <td>{{ order.quantity }}</td>
        <td>₹{{ "%.2f"|format(order.price) }}</td>
        <td>{{ order.created_at.strftime('%Y-%m-%d %H:%M') }}</td>

        <td>
          <form method="POST" action="{{ url_for('admin_delete_full_order', order_id=order.id) }}">
            <button class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this record?')">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}